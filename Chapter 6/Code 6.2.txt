global class FB_Acc_Details_onRecord{
	webService static void details(String recordid) {
	String endpoint  = Facebook_Custom_Setting__c.getInstance( 'Facebook Endpoint' ).Value__c;

	HttpRequest httpReq  = new HttpRequest();
	Http http            = new Http();
	HttpResponse httpRes = new HttPResponse();
	httpReq.setMethod('GET');
	httpReq.setEndpoint(endpoint);

	String authorizationHeader = 'Bearer EAAJ6yTJ5kGMBAHPPYWc2iuUViAblUClTIqFhIvQ2TDZAayNFTkeZCb6HhPWjZBOx8eIDTynCSSTwm17z69ZAR0XfNHunc69cgCCyNZABluB9JeWanfI4ueRYSnzZCqZA7cxdw47HB6Wq0XARnxJE1VpYTFAMLnoGAqNBKdaaEQbOpVzFZBUxlsvio5pmFhyZBbFLU21KXPAGM5QZDZD';
	httpReq.setHeader('Authorization', authorizationHeader);
	httpRes = http.send( httpReq );
	System.debug(httpRes.getBody());

	JSONParser parser = JSON.createParser(httpRes.getBody()); 
	   string name = '';
	   string birthday= '';
	   string email= '';
	   string hometown= '';   
	   list<string> namelist = new list<string>();    
        while (parser.nextToken() != null) {
            if ((parser.getCurrentToken() == JSONToken.FIELD_NAME) && 
                (parser.getText() == 'name')) {
                // Get the value.
                parser.nextToken();                
                name = parser.gettext();
                namelist.add(name);  
                system.debug('hometown--------------------- '+ namelist[0]);             
            }
            
            if ((parser.getCurrentToken() == JSONToken.FIELD_NAME) && 
                (parser.getText() == 'birthday')) {
                // Get the value.
                parser.nextToken();                
                birthday = parser.gettext();
                system.debug('birthday--------------------- '+ birthday);
            }
            if ((parser.getCurrentToken() == JSONToken.FIELD_NAME) && 
                (parser.getText() == 'email')) {
                // Get the value.
                parser.nextToken();                
                email= parser.gettext();
                system.debug('email--------------------- '+ email);
            }
            if ((parser.getCurrentToken() == JSONToken.FIELD_NAME) && 
                (parser.getText() == 'hometown')) {
                // Get the value.
                parser.nextToken();                
                hometown= parser.gettext();
                
            }
        }                       
  system.debug('namelist--------------------- '+ namelist);
  
 //update the existing record with the facebook profile info as follows
    FB_info__c fp = new FB_info__c();   
    fp.Name__c= namelist[0];
    fp.Birthdate__c = birthday;
    fp.Email__c= email;
    fp.Hometown__c = namelist[1];        
    fp.id = recordid;
    update fp;   
    }
}